# sksctl

ç”¨äºŽæŸäº›åœ°æ–¹æ ¡å›­ç½‘çš„ CLI å·¥å…·åŒ…

---

# å…è´£å£°æ˜Ž

è¿™ä¸ªé¡¹ç›®çš„ç›®çš„æ˜¯ **å­¦ä¹ webé€†å‘çš„æŠ€èƒ½ï¼Œå¹¶å……åˆ†åˆ©ç”¨CDHTçš„æ ¡å›­ç½‘ç»œï¼ˆä½ çŸ¥é“å®ƒåœ¨å“ªé‡Œï¼‰** ã€‚

å®ƒ **ä¸æ˜¯** ä¸ºä»¥ä¸‹è¡Œä¸ºè®¾è®¡çš„ï¼š
- ç ´è§£ä»»ä½•ç³»ç»Ÿï¼›
- çªƒå–ä»»ä½•äººçš„è´¦æˆ·ï¼›
- é˜»æ­¢ä»»ä½•äººå°†ä»–/å¥¹çš„æ–°è®¾å¤‡ä¸Žä»–/å¥¹çš„è´¦æˆ·ç»‘å®šï¼›
- ç¦æ­¢ä»»ä½•è®¾å¤‡ä½¿ç”¨æ ¡å›­ç½‘ï¼›

æˆ–ä»»ä½•å…¶ä»–ç±»ä¼¼çš„æœ‰æ¯’äº‹æƒ…ã€‚

ç”¨æˆ· **ä¸åº”è¯¥** ä½¿ç”¨è¿™äº›è„šæœ¬æ¥åšä»»ä½•æœ‰å®³çš„äº‹æƒ…ã€‚æˆ‘ä»¬çš„è´¡çŒ®è€… **ä¸** å¯¹ä»»ä½•æ»¥ç”¨è¡Œä¸ºè´Ÿè´£ã€‚

~~ç»´æŠ¤è€… **æ²¡æœ‰** å£°ç§°å¥¹ **ä¸æ˜¯** ä¸€ä¸ªçŒ«å¨˜ã€‚ä½  **åº”è¯¥** æŠšæ‘¸å¥¹çš„è€³æœµã€‚~~

~~æˆ‘æ˜¯è„šæœ¬å°çŒ«~~

# æè¿°

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªè‡ªåŠ¨åˆ©ç”¨SKSï¼ˆæŸå…¬å¸ï¼‰çš„æ™ºèƒ½å¤šä¸šåŠ¡ç½‘å…³ï¼ˆå¹¿æ³›ç”¨äºŽå­¦æ ¡çš„å…¬å…±æ— çº¿ç½‘ç»œï¼Œä¾‹å¦‚åœ¨ [æ­¤åˆ—è¡¨](http://www.skspruce.com.cn/news/10/) ä¸­çš„å­¦æ ¡ï¼‰çš„ **å…¬å…±** APIçš„å·¥å…·ã€‚

æ ¹æ®å®ƒå‘é€HTTPè¯·æ±‚çš„APIï¼Œå®ƒå¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼ŒåŒ…æ‹¬ï¼š

- [x] å…æ”¹ URLï¼Œä¸€é”®ï¼ˆç”šè‡³è‡ªåŠ¨ï¼‰å°†ä½ çš„è®¾å¤‡è¿žæŽ¥åˆ°äº’è”ç½‘ï¼›
- [x] ä½¿ç”¨è‡ªåŠ¨ç”ŸæˆéšæœºMACã€å†™å…¥ç™½åå•ç­‰æ‰‹æ®µé˜²æ­¢ä½ çš„è®¾å¤‡è¢«è€å¸ˆæ‹‰é»‘ï¼›
- [x] ä½¿ç”¨å¤‡ç”¨è´¦æˆ·æ°¸ä¹…æ³¨å†Œä½ çš„è®¾å¤‡ï¼›
- [x] è‡ªåŠ¨è®°å½•ä½ åŒå­¦ä»¬çš„ç™»å½•æ´»åŠ¨å¹¶è¿›è¡Œç»Ÿè®¡ï¼›

_ç­‰ç­‰..._

è¿˜æœ‰å¾ˆå¤šåŠŸèƒ½è¿˜æ²¡æœ‰å®žçŽ°ï¼š

- [ ] åˆ›å»ºè‡ªå·±çš„è´¦æˆ·ï¼Œä»¥åŠä¸ºäº†å®‰å…¨èµ·è§ï¼Œä½¿ç”¨åŽå°†å…¶åˆ é™¤ï¼›
- [ ] æ“çºµç™»å½•é—¨æˆ·ï¼Œæ¯”å¦‚é‡ç½®è¢«ç¦æ­¢çš„ç™»å½•é—¨æˆ·ï¼Œæˆ–è€…æ”¹å˜å®ƒä»¬çš„ç™»å½•æ–¹å¼ï¼›

_..._

äº‹å®žä¸Šï¼Œæˆ‘ä»¬çš„ç»´æŠ¤è€…ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™æ ·é‡è¦çš„APIä¼šåœ¨æ²¡æœ‰ä»»ä½•è®¤è¯çš„æƒ…å†µä¸‹æš´éœ²ç»™å…¬ä¼—ã€‚ç„¶è€Œï¼Œå®ƒä»¬å·²ç»è¢«æš´éœ²äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒä»¬ã€‚

# çŽ¯å¢ƒ

æˆ‘ä»¬æ”¯æŒ `Termux` ï¼Œå®‰å“è®¾å¤‡ä¸Šçš„é«˜çº§ç»ˆç«¯æ¨¡æ‹Ÿå™¨ã€‚

> æ³¨æ„ï¼šè¿™å¥—è„šæœ¬ **åª** ä¸º [Termux](https://github.com/termux/termux-app) è®¾è®¡ã€‚ä¸è¦é—®ä¸ºä»€ä¹ˆå®ƒä¸èƒ½åœ¨ä½ çš„ _manylinux_ æœºå™¨ä¸Šè¿è¡Œã€‚
>
> å¦‚æžœä½ å†³å¿ƒè¿™æ ·åšï¼Œä½ å¯ä»¥å°è¯•è¿è¡Œä¸€ä¸ª[Dockerä¸­çš„Termuxå®¹å™¨](https://github.com/termux/termux-docker) ã€‚è¿™ç§æ–¹å¼æ˜¯ç”±Termuxå›¢é˜Ÿæ­£å¼æ”¯æŒçš„ã€‚ä½†åœ¨æˆ‘ä»¬çŽ°åœ¨çš„è®¡åˆ’ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šæ­£å¼æ”¯æŒå®ƒæˆ–ä»»ä½• _manylinux_ ç³»ç»Ÿã€‚

ä»Ž[F-DROID](https://f-droid.org/) å®‰è£…è¿™ä¸ªåº”ç”¨ç¨‹åºï¼š

- [Termux](https://f-droid.org/en/packages/com.termux)
- [Termux:Styling](https://f-droid.org/en/packages/com.termux.styling)

ç¬¬ä¸€ä¸ªæ˜¯æœ¬ä½“, ç¬¬äºŒä¸ªæ˜¯æ’ä»¶ã€‚å¦‚æžœä½ æƒ³æ¢æ›´å¥½çœ‹çš„ç»ˆç«¯å­—ä½“ã€ç»ˆç«¯ä¸»é¢˜ï¼Œæˆ–è€…ä½ è®¾å¤‡ä¸Š `Termux` çš„å­—ä½“éžå¸¸è¯¡å¼‚ï¼ˆé€šå¸¸æ˜¯ç”±äºŽè®¾å¤‡æ²¡æœ‰å†…ç½®ç­‰å®½å­—ä½“ï¼Œæ¸²æŸ“å™¨å¼ºè¡Œå°†éžç­‰å®½å­—ä½“æ‹‰ä¼¸æˆç­‰å®½å¯¼è‡´çš„ï¼‰ï¼Œä½ å°±éœ€è¦ `Termux Styling` ã€‚

åº”ä»ŽåŒä¸€æ¥æºï¼ˆä¾‹å¦‚ F-DROIDï¼‰ä¸‹è½½å®‰è£… `Termux` åŠå…¶å…¨éƒ¨æ’ä»¶ã€‚å¦åˆ™ï¼Œæ’ä»¶ä¼šå› ä¸º Shared UID é”™è¯¯è€Œæ— æ³•æˆåŠŸå®‰è£…ã€‚

> å°å¿ƒï¼Œå®‰è£… Kali Nethunter é™„å¸¦çš„ â€œF-DROIDâ€ èƒŒåŽæ˜¯ Kali è‡ªå·±çš„æž„å»ºç³»ç»Ÿã€‚ä½¿ç”¨å®ƒä¼šä¸å…¼å®¹çœŸæ­£çš„ F-DROID é‡Œä¸‹è½½çš„æ’ä»¶ã€‚
>
> å¦å¤–ï¼Œæˆ‘ä»¬ä¸çŸ¥é“UTermuxæˆ–ä»»ä½•å…¶ä»–ç±»ä¼¼çš„æ€ªä¸œè¥¿æ˜¯å¦ä¸Žsksctlå…¼å®¹ã€‚ä½ åº”è¯¥è‡ªå·±è¯•è¯•ï¼ˆè¿™å¥è¯æ„å‘³ç€æ²¡æœ‰ä»»ä½•æ­£å¼æ”¯æŒï¼‰ã€‚

# å®‰è£…

## é€‰æ‹©æœ€å¿«çš„é•œåƒ

åœ¨å®‰è£…`git`å’Œ/æˆ–å®‰è£…æˆ‘ä»¬çš„å·¥å…·ä¹‹å‰ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªç¦»ä½ å¾ˆè¿‘çš„Termuxè½¯ä»¶åŒ…ä»“åº“é•œåƒï¼Œä»¥èŽ·å¾—æ›´é«˜çš„ä¸‹è½½é€Ÿåº¦ã€‚

```shell
termux-change-repo
```
è¿™ä¸ªå‘½ä»¤ä¼šè‡ªåŠ¨è¿è¡Œ`apt update`ï¼Œå› æ­¤ä½ çš„è½¯ä»¶åŒ…ç®¡ç†å™¨çš„ç¼“å­˜ä¼šæ˜¯æœ€æ–°çš„ã€‚

å¦‚æžœä½ ä»¥å‰æžè¿‡è¿™ä¸ªï¼Œä½ å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥ã€‚ä½œä¸ºæ›¿ä»£ï¼Œä½ å°†éœ€è¦è¿è¡Œ `apt update`ã€‚

## clone è¿™ä¸ªä»“åº“

`git` æ˜¯ç”¨æ¥ clone è¿™ä¸ªä»“åº“åˆ°ä½ çš„è®¾å¤‡ä¸Šçš„å·¥å…·ã€‚å¦‚æžœè¿˜æ²¡æœ‰å®‰è£…ï¼Œè¯·å®‰è£…å®ƒã€‚

```shell
apt install git
```

å¾ˆæ˜Žæ˜¾ä¸‹ä¸€æ­¥å°±æ˜¯cloneè¿™ä¸ª repoã€‚æˆ–è€…ä½ å¯ä»¥forkæˆ‘çš„ï¼Œç„¶åŽcloneä½ çš„ã€‚æ¬¢è¿Žè¿™ä¹ˆå¹²ã€‚

```shell
git clone https://github.com/MalachiteN/sksctl.git
cd sksctl
```
## æ‰‹åŠ¨å®‰è£…

### å®‰è£…ä¾èµ–é¡¹

```shell
apt install vim sqlite iproute2
```

- æˆ‘ä»¬éœ€è¦`vim`æ¥æ‰§è¡Œ`xxd`å‘½ä»¤ï¼Œå®ƒåœ¨ç”ŸæˆéšæœºMACå’Œç¼–ç URIæ–¹é¢èµ·ç€é‡è¦ä½œç”¨ï¼›
- `sqlite`ä¸ºæˆ‘ä»¬æä¾›äº†ç®¡ç†æ”¶é›†çš„å­¦ç”Ÿç™»å½•æ´»åŠ¨ä¿¡æ¯çš„èƒ½åŠ›ï¼›
- ä¸ºäº†å¾—åˆ°ä½ ç½‘å…³çš„IPå’ŒMACåœ°å€ï¼Œæˆ‘ä»¬éœ€è¦`iproute2`ï¼Œå®ƒæä¾›`ip`å‘½ä»¤ã€‚

### å¤åˆ¶æ–‡ä»¶å’Œè®¾å®šæƒé™

çŽ°åœ¨ï¼Œå®‰è£…ç›®å½•**å¿…é¡»**æ˜¯`~/.local/share/kdsy`ã€‚å¦åˆ™ï¼Œä¸€äº›åŠŸèƒ½ï¼ˆç‰¹åˆ«æ˜¯è‡ªåŠ¨ä¿¡æ¯æ”¶é›†ï¼‰å°†æ— æ³•å·¥ä½œã€‚

> è¿™æ˜¯å› ä¸ºè¯¥è„šæœ¬æ›¾ç»è¢«å‘½åä¸º`kdsy`ï¼Œæ˜¯ç»´æŠ¤è€…å­¦æ ¡çš„åç§°ç¼©å†™ã€‚
>
> çŽ°åœ¨ï¼Œä½ ä»ç„¶å¯ä»¥è°ƒç”¨`kdsy`ã€‚ä¸è¿‡å®ƒçŽ°åœ¨æ˜¯`sksctl`çš„ä¸€ä¸ªå…·æœ‰ç‰¹å®šçŽ¯å¢ƒå˜é‡ï¼ˆä½¿ç”¨æœ¬æ ¡ç½‘å…³IPä¸ŽMACï¼‰çš„åˆ«åã€‚

``shell
insdir='~/.local/share/kdsy' ã€‚
crondir=$PREFIX'/var/spool/cron/'
mkdir -p $crondir
mkdir -p $insdir
cp -r . $insdir
chmod +x $insdir/bin/*
chmod +x $insdir/kdsy
```

çŽ°åœ¨å®ƒå·²ç»å®‰è£…å¥½äº†ã€‚å¦‚æžœä½ æ˜¯æˆ‘æ ¡å‹ï¼Œä½ å¯ä»¥è¿è¡Œ`kdsy`è¿›è¡Œæµ‹è¯•ã€‚

### é…ç½®çŽ¯å¢ƒå˜é‡

å¯¹äºŽæ›´é€šç”¨çš„ç”¨é€”ï¼Œä½ éœ€è¦è¿™ä¸ªæ­¥éª¤ã€‚

``shell
ac=`ip route show table all|grep '^default'|cut -d' ' -f3`ã€‚
ac_mac=`arp $ac|grep $ac|sed 's/\s\+/\t/g'|cut -f3`ã€‚
echo 'export KDSY=~/.local/share/kdsy' >> ~/.profile
echo 'export PATH=$PATH:$KDSY' >> ~/.profile
echo 'export ACIP='""$ac"'">> ~/.profile
echo 'export ACMAC='"'"$ac_mac"'">> ~/.profile
# ä¸è¦å®³æ€•å¿˜è®°å¦‚ä½•é€€å‡ºvim!>w<
source ~/.profile
```

## ä½¿ç”¨å®‰è£…è„šæœ¬

é™¤äº†æ‰‹åŠ¨å®‰è£…ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªè‡ªåŠ¨å®‰è£…è„šæœ¬ã€‚

**ä½†æ˜¯ï¼Œå®ƒè¿˜æ²¡æœ‰å®Œæˆï¼Œè€Œä¸”å……æ»¡äº†é”™è¯¯ã€‚æ¬¢è¿Žæå‡ºPRã€‚**

``shell
# chmod +x install.sh ï¼ˆå¦‚æžœéœ€è¦çš„è¯ï¼‰
./install.sh -i
source ~/.profile
```

è¿™å°†æ˜¯ç®€å•çš„ï¼Œä½†çŽ°åœ¨å®ƒç»™ä½ çš„TermuxçŽ¯å¢ƒå¸¦æ¥ä¸¥é‡çš„é—®é¢˜ã€‚**ä¸è¦ä½¿ç”¨å®ƒï¼**ã€‚

ä¸€æ—¦å®‰è£…ç¨‹åºè„šæœ¬ç¨³å®šä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒè®¾ç½®ä¸ºæŽ¨èçš„å®‰è£…æ–¹æ³•ã€‚

## å®Œæˆ!ðŸ˜‹

`sksctl`çŽ°åœ¨åº”è¯¥å·¥ä½œäº†ã€‚è¾“å…¥`sksctl`å’Œä¸€äº›å­å‘½ä»¤æ¥æµ‹è¯•å®ƒæ˜¯å¦è¢«æ­£ç¡®å®‰è£…ã€‚

å¦‚æžœä½ æƒ³è®¾ç½®è‡ªåŠ¨ä¿¡æ¯æ”¶é›†åŠŸèƒ½ï¼Œè¯·æŸ¥çœ‹[è®¾ç½®crontab](#è®¾ç½®crontab)éƒ¨åˆ†çš„è¯´æ˜Žã€‚

# ç”¨æ³•

```shell
sksctl help
```

ä½ å¯èƒ½å¯¹ Linux CLI ä¸ç†Ÿæ‚‰ã€‚ä¸è¦æƒŠæ…Œï¼Œå†·é™ä¸‹æ¥ï¼Œå¹¶å°è¯•æŽ¢ç´¢å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬çš„å·¥å…·ã€‚

è¿™é‡Œå”¯ä¸€çš„æç¤ºæ˜¯ "sksctl help"ã€‚

# è®¾ç½®crontab

è‡ªåŠ¨ä¿¡æ¯æ”¶é›†åŠŸèƒ½éœ€è¦è¿™ä¸ªæ­¥éª¤ã€‚ä½ åªæœ‰åœ¨èŽ·å– root ä¹‹åŽæ‰èƒ½å¯ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚

åœ¨Linuxä¸­ï¼Œç¨‹åº`Cron`æ‰§è¡Œæˆ‘ä»¬å®‰æŽ’çš„å‘½ä»¤ã€‚æ—¶é—´è¡¨è¢«ç§°ä¸º`crontab`ã€‚æˆ‘ä»¬ä½¿ç”¨`crontab -e`æ¥ç¼–è¾‘æˆ‘ä»¬çš„ä»»åŠ¡æ—¶é—´è¡¨ã€‚

åœ¨Termuxä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å®‰è£…å®ƒã€‚å®ƒå±žäºŽè½¯ä»¶æº`root-repo`ã€‚

```shell
apt install root-repo
apt update
apt install termux-service runit crontab
```

æ— éœ€äººå·¥è¾“å…¥æ—¶é—´è¡¨ã€‚æŠŠé¢„è®¾çš„crontabå¤åˆ¶åˆ°ä½ çš„Croné…ç½®ç›®å½•ã€‚

```shell
cp $KDSY/crontab.rc $PREFIX/var/spool/cron/`whoami`ã€‚
```

æœ€åŽï¼Œ`crond`ï¼ˆcrontabçš„å®ˆæŠ¤è¿›ç¨‹ï¼‰éœ€è¦ä¸€ç‚¹å¸®åŠ©æ‰èƒ½å¯ç”¨ã€‚

```shell
sv-enable crond
```

# å¸®åŠ©æˆ‘ä»¬

æˆ‘ä»¬çš„é¡¹ç›®éœ€è¦ä½ çš„å¸®åŠ©! å¦‚æžœä½ èƒ½ä¸ºæˆ‘ä»¬åšè¿™äº›äº‹ï¼Œæˆ‘ä»¬ä¼šå¾ˆæ„Ÿæ¿€ä½ ï¼š

## å®‰è£…ç¨‹åºè„šæœ¬æµ‹è¯•

å¦‚æžœä½ æœ‰ä¸€ä¸ªå¹²å‡€çš„Dockerå®¹å™¨æˆ–ä¸€ä¸ªå¤‡ç”¨çš„Androidè®¾å¤‡ï¼Œä½ å¯ä»¥å¸®åŠ©æˆ‘ä»¬æµ‹è¯•æˆ‘ä»¬çš„å®‰è£…è„šæœ¬ã€‚

## ä¸ºä½ çš„å­¦æ ¡æµ‹è¯•ï¼ˆå¦‚æžœéœ€è¦ï¼Œç§»æ¤ï¼‰å®ƒ

å¦‚æžœä½ åœ¨ [æ­¤åˆ—è¡¨](http://www.skspruce.com.cn/news/10/) ä¸­çš„å­¦æ ¡ä¸Šå­¦ï¼Œä½ å¯ä»¥æµ‹è¯• `sksctl` æ˜¯å¦åœ¨ä½ å­¦æ ¡çš„å…¬å…±æ— çº¿ç½‘ç»œä¸­å·¥ä½œã€‚
å¦‚æžœå®ƒä¸èƒ½å·¥ä½œï¼Œä½†ä½ æœ‰è§£å†³æ–¹æ¡ˆï¼Œæ¬¢è¿Žæ–°å»ºä½ çš„åˆ†æ”¯å¹¶å°†æˆ‘ä»¬çš„è„šæœ¬ç§»æ¤åˆ°ä½ çš„å­¦æ ¡ã€‚è¿™å¯¹ä½ å’Œä½ çš„åŒå­¦ï¼Œå½“ç„¶è¿˜æœ‰æˆ‘ä»¬çš„é¡¹ç›®ï¼Œéƒ½æ˜¯æœ‰ç›Šçš„ã€‚

é€šè¿‡DeepLç¿»è¯‘ https://www.deepl.com/app/?utm_source=android&utm_medium=app&utm_campaign=share-translation
